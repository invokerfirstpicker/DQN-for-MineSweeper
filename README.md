# üéÆ DQN Minesweeper AI

A project to train artificial intelligence to play the classic Minesweeper game using the Deep Q-Network (DQN).

## üìã Project Description

This project demonstrates the use of deep Reinforcement Learning to create an AI agent capable of playing minesweeper. The agent is trained using the Deep Q-Network algorithm and can play on a 16x16 field with 40 mines.

## üèóÔ∏è Project architecture

``
DQN and Minesweeper Game/
‚îú‚îÄ‚îÄ ai_minesweeper.py # GUI for demonstrating trained AI
‚îú‚îÄ‚îÄ minesweeper_env.py # RL-Agent training environment
,‚îÄ‚îÄ train_dqn.py # DQN Agent training script
‚îú‚îÄ‚îÄ run_ai_game.py # Launching an AI demonstration
,‚îÄ‚îÄ minesweeper.py # Classic human game
,‚îÄ‚îÄ dqn_agent.py # Implementing
the DQN agent ‚îú‚îÄ‚îÄ requirements.txt # Project dependencies
,‚îÄ‚îÄ README.md # Documentation
```

## üöÄ Quick Start

### 1. Installing dependencies

```bash
pip install -r requirements.txt
```

### 2. Agent Training

```bash
python train_dqn.py
```

The training will take some time. The model will be saved to the `dqn_weights.pth` file every 500 episodes.

###3. Launching an AI demonstration

```bash
python run_ai_game.py
```

Or directly:

```bash
python ai_minesweeper.py
```

## üéØ Main components

### ü§ñ DQN Agent (`dqn_agent.py `)
- Implementation of the Deep Q-Network agent
- Uses PyTorch for a neural network
- Supports saving/loading of trained models

### üéÆ RL Environment (`minesweeper_env.py `)
is a Gym-compatible learning environment
- State: 16x16 matrix (closed/open cells, numbers)
- Actions: coordinates of the cell to open
- Rewards: +10 for victory, -10 for defeat, +0.1 for each open square

### üñ•Ô∏è AI Demo (`ai_minesweeper.py`)
- Graphical interface for AI demonstration
- Automatic game with adjustable speed
- Game statistics (number of games played/won)
- Automatic restart when auto-play is enabled

### üé≤ Human Game (`minesweeper.py `)
is a classic minesweeper game for humans
- Graphical interface on tkinter

## üéÆ Management in AI Demo

### Control buttons:
- **"Auto Play"** - starts/stops the AI automatic game
- **"One move"** - The AI makes one move
- **"New Game"** - starts a new game and resets stats

### Settings:
- **Speed (ms)** - delay between AI moves (500ms by default)

### Features:
- ‚úÖ **Automatic restart** - When auto-play is enabled, the game automatically restarts after winning/losing
- üìä **Statistics** - shows the number of games played and wins
- ***Endless game** - The AI can play continuously until you stop

## üß† Technical Details

### Game status:
- `-3` - closed cell
- `-1` - mine (visible only when hit)
- `0` - empty cell
- `1-8` - the number of mines around

### DQN Architecture:
- Input layer: 16x16 (field state)
- Hidden layers: fully connected layers
- Output layer: 256 actions (16x16 cells)

### Hyperparameters of learning:
- Episodes: 10,000
- Saving the model: every 500 episodes
- Epsilon-greedy: starts at 1.0, decreases to 0.01

## üìä Results

After training, the agent must show:
- Winning percentage: 60-80% (depends on the quality of training)
- Average number of moves to win
- Ability to avoid obvious mines

## üîß Requirements

- Python 3.7+
- PyTorch
- NumPy
- tkinter (usually included in Python)

## üìù Usage examples

### Learning from scratch:
``python
python train_dqn.py
``

### Continuing education:
```python
# The model will load automatically from dqn_weights.pth
python train_dqn.py
``

### Demonstration of AI:
```python
python run_ai_game.py
```

### Human game:
`python
python minesweeper.py
``

## üéØ Possible improvements

1. **Architecture improvement** - adding convolutional layers
2. **Other algorithms** - PPO, A3C, SAC
3. **Different field sizes** - Training in fields of different sizes
4. **Visualization of learning** - progress charts
5. **Multithreading** - parallel learning

## ü§ù Contribution to the project

Welcome:
- Bug fixes
- Algorithm improvements
- New features
- Documentation

## üìÑ License

This project was created for educational purposes.

---

** Have a good game! üéÆ‚ú®**
# üéÆ DQN Minesweeper AI

–ü—Ä–æ–µ–∫—Ç –ø–æ –æ–±—É—á–µ–Ω–∏—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏–≥—Ä–∞—Ç—å –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É "–°–∞–ø–µ—Ä" —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Deep Q-Network (DQN).

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (Reinforcement Learning) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ò–ò-–∞–≥–µ–Ω—Ç–∞, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –∏–≥—Ä–∞—Ç—å –≤ —Å–∞–ø–µ—Ä. –ê–≥–µ–Ω—Ç –æ–±—É—á–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Deep Q-Network –∏ –º–æ–∂–µ—Ç –∏–≥—Ä–∞—Ç—å –Ω–∞ –ø–æ–ª–µ 16x16 —Å 40 –º–∏–Ω–∞–º–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DQN and Minesweeper Game/
‚îú‚îÄ‚îÄ ai_minesweeper.py      # GUI –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–Ω–æ–≥–æ –ò–ò
‚îú‚îÄ‚îÄ minesweeper_env.py     # RL-—Å—Ä–µ–¥–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ train_dqn.py          # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è DQN –∞–≥–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ run_ai_game.py        # –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ò–ò
‚îú‚îÄ‚îÄ minesweeper.py        # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞
‚îú‚îÄ‚îÄ dqn_agent.py          # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DQN –∞–≥–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –û–±—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞

```bash
python train_dqn.py
```

–û–±—É—á–µ–Ω–∏–µ –∑–∞–π–º–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è. –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ —Ñ–∞–π–ª `dqn_weights.pth` –∫–∞–∂–¥—ã–µ 500 —ç–ø–∏–∑–æ–¥–æ–≤.

### 3. –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ò–ò

```bash
python run_ai_game.py
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
python ai_minesweeper.py
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ü§ñ DQN Agent (`dqn_agent.py`)
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Deep Q-Network –∞–≥–µ–Ω—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PyTorch –¥–ª—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫—É –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

### üéÆ RL Environment (`minesweeper_env.py`)
- –°–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å Gym —Å—Ä–µ–¥–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –°–æ—Å—Ç–æ—è–Ω–∏–µ: –º–∞—Ç—Ä–∏—Ü–∞ 16x16 (–∑–∞–∫—Ä—ã—Ç—ã–µ/–æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–ª–µ—Ç–∫–∏, —á–∏—Å–ª–∞)
- –î–µ–π—Å—Ç–≤–∏—è: –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–µ—Ç–∫–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è
- –ù–∞–≥—Ä–∞–¥—ã: +10 –∑–∞ –ø–æ–±–µ–¥—É, -10 –∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ, +0.1 –∑–∞ –∫–∞–∂–¥—É—é –æ—Ç–∫—Ä—ã—Ç—É—é –∫–ª–µ—Ç–∫—É

### üñ•Ô∏è AI Demo (`ai_minesweeper.py`)
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ò–ò
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö/–≤—ã–∏–≥—Ä–∞–Ω–Ω—ã—Ö)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π –∞–≤—Ç–æ–∏–≥—Ä–µ

### üé≤ Human Game (`minesweeper.py`)
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ —Å–∞–ø–µ—Ä –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ tkinter

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ AI Demo

### –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **"–ê–≤—Ç–æ–∏–≥—Ä–∞"** - –∑–∞–ø—É—Å–∫–∞–µ—Ç/–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É –ò–ò
- **"–û–¥–∏–Ω —Ö–æ–¥"** - –ò–ò –¥–µ–ª–∞–µ—Ç –æ–¥–∏–Ω —Ö–æ–¥
- **"–ù–æ–≤–∞—è –∏–≥—Ä–∞"** - –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–æ–≤—É—é –∏–≥—Ä—É –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
- **–°–∫–æ—Ä–æ—Å—Ç—å (–º—Å)** - –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Ö–æ–¥–∞–º–∏ –ò–ò (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 500–º—Å)

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π –∞–≤—Ç–æ–∏–≥—Ä–µ –∏–≥—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–±–µ–¥—ã/–ø–æ—Ä–∞–∂–µ–Ω–∏—è
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö –∏–≥—Ä –∏ –ø–æ–±–µ–¥
- üéØ **–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –∏–≥—Ä–∞** - –ò–ò –º–æ–∂–µ—Ç –∏–≥—Ä–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ, –ø–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ

## üß† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã:
- `-3` - –∑–∞–∫—Ä—ã—Ç–∞—è –∫–ª–µ—Ç–∫–∞
- `-1` - –º–∏–Ω–∞ (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ—Ä–∞–∂–µ–Ω–∏–∏)
- `0` - –ø—É—Å—Ç–∞—è –∫–ª–µ—Ç–∫–∞
- `1-8` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ–∫—Ä—É–≥

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ DQN:
- –í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 16x16 (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—è)
- –°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏
- –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 256 –¥–µ–π—Å—Ç–≤–∏–π (16x16 –∫–ª–µ—Ç–æ–∫)

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:
- –≠–ø–∏–∑–æ–¥—ã: 10,000
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏: –∫–∞–∂–¥—ã–µ 500 —ç–ø–∏–∑–æ–¥–æ–≤
- Epsilon-greedy: –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1.0, —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ 0.01

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∞–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥: 60-80% (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—É—á–µ–Ω–∏—è)
- –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö–æ–¥–æ–≤ –¥–æ –ø–æ–±–µ–¥—ã
- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏–∑–±–µ–≥–∞—Ç—å –æ—á–µ–≤–∏–¥–Ω—ã—Ö –º–∏–Ω

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- PyTorch
- NumPy
- tkinter (–æ–±—ã—á–Ω–æ –≤–∫–ª—é—á–µ–Ω –≤ Python)

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è:
```python
python train_dqn.py
```

### –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è:
```python
# –ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏–∑ dqn_weights.pth
python train_dqn.py
```

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ò–ò:
```python
python run_ai_game.py
```

### –ò–≥—Ä–∞ —á–µ–ª–æ–≤–µ–∫–æ–º:
```python
python minesweeper.py
```

## üéØ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–£–ª—É—á—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤
2. **–î—Ä—É–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** - PPO, A3C, SAC
3. **–†–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–ª—è** - –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª—è—Ö —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è** - –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
5. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è:
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- –£–ª—É—á—à–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.

---

**–£–¥–∞—á–Ω–æ–π –∏–≥—Ä—ã! üéÆ‚ú®** 
